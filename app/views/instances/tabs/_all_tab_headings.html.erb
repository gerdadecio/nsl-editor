<% increment_tab_index %>

<ul class="nav nav-tabs">

  <% this_tab = 'tab_show_1' %>

  <% if @tabs_to_offer.include?('tab_show_1') %>
    <% if can? 'instances', 'tab_show_1' %>
      <%= render partial: 'instances/tabs/tab', locals: {first: true,
                                        last: false,
                                        this_tab: 'tab_show_1', 
                                        link_text: "Details".html_safe,
                                        link_id: 'instance-show-tab', 
                                        link_title: 'Details',
                                        tab_index: @tab_index,
                                        prev_tab: '.search-result.show-details', 
                                        next_tab: '' } %>
    <% end %>
  <% end %>

  <% if @tabs_to_offer.include?('tab_edit') %>
    <% if can? 'instances', 'edit' %>
      <%= render partial: 'instances/tabs/tab', locals: {first: false,
                                        last: false,
                                        this_tab: 'tab_edit', 
                                        link_text: "Edit".html_safe,
                                        link_id: 'instance-edit-tab', 
                                        link_title: 'Edit',
                                        tab_index: increment_tab_index,
                                        prev_tab: '',
                                        next_tab: '' } %>
    <% end %>
  <% end %>

  <% if @tabs_to_offer.include?('tab_edit_notes') %>
    <% if can? 'instance_notes', 'edit' %>
      <%= render partial: 'instances/tabs/tab', locals: {first: false,
                                        last: false,
                                        this_tab: 'tab_edit_notes', 
                                        link_text: "Notes".html_safe,
                                        link_id: 'instance-edit-notes-tab', 
                                        link_title: 'Notes',
                                        tab_index: increment_tab_index,
                                        prev_tab: '',
                                        next_tab: '' } %>
    <% end %>
  <% end %>
  
  <% if @tabs_to_offer.include?('tab_synonymy') %>
    <% if can? 'instances', 'create' %>
      <%= render partial: 'instances/tabs/tab', locals: {first: false,
                                          last: false,
                                          this_tab: 'tab_synonymy',
                                          link_text: "Syn".html_safe,
                                          link_id: 'instance-cite-this-instance-tab',
                                          link_title: 'Synonym',
                                          tab_index: increment_tab_index,
                                          prev_tab: '',
                                          next_tab: ''} %>
    <% end %>
  <% end %>

  <% if @tabs_to_offer.include?('tab_unpublished_citation') %>
    <% if can? 'instances', 'create' %>
      <%= render partial: 'instances/tabs/tab', locals: {first: false,
                                          last: false,
                                          this_tab: 'tab_unpublished_citation',
                                          link_text: "Unpub".html_safe,
                                          link_id: 'unpublished-citation-tab',
                                          link_title: 'Unpublished citation',
                                          tab_index: increment_tab_index,
                                          prev_tab: '',
                                          next_tab: ''} %>
    <% end %>
  <% end %>

  <% if @tabs_to_offer.include?('tab_classification') %>
      <% if can? 'classification', 'place' %>
          <%= render partial: 'instances/tabs/tab', locals: {first: false,
                                                             last: false,
                                                             this_tab: 'tab_classification',
                                                             link_text: "Tree".html_safe,
                                                             link_id: 'instance-classification-tab',
                                                             link_title: 'Tree placement',
                                                             tab_index: increment_tab_index,
                                                             prev_tab: '',
                                                             next_tab: ''} %>
      <% end %>
  <% end %>

  <% if @tabs_to_offer.include?('tab_comments') %>
    <% if can? 'comments', 'create' %>
      <%= render partial: 'instances/tabs/tab', locals: {first: false,
                                        last: true,
                                        this_tab: 'tab_comments', 
                                        link_text: "Adnot".html_safe,
                                        link_id: 'instance-comments-tab', 
                                        link_title: 'Adnot',
                                        tab_index: increment_tab_index,
                                        prev_tab: '',
                                        next_tab: '' } %>
    <% end %>
  <% end %>

  <% if @tabs_to_offer.include?('tab_copy_to_new_reference') %>
    <% if can? 'instances', 'copy_standalone' %>
      <%= render partial: 'instances/tabs/tab', locals: {first: false,
                                        last: false,
                                        this_tab: 'tab_copy_to_new_reference', 
                                        link_text: "Copy".html_safe,
                                        link_id: 'instance-copy-to-new-reference-tab', 
                                        link_title: 'Copy the instance',
                                        tab_index: increment_tab_index,
                                        prev_tab: 'instance-comments-tab',
                                        next_tab: '.search-result.show-details' } %>
    <% end %>
  <% end %>

  <% if @tabs_to_offer.include?('tab_profile_details') %>
    <% if can? 'classification', 'place' %>
      <%= render partial: 'instances/tabs/tab', locals: {first: false,
                                        last: false,
                                        this_tab: 'tab_profile_details', 
                                        link_text: "Profile".html_safe,
                                        link_id: 'instance-profile-tab', 
                                        link_title: 'Profile details',
                                        tab_index: increment_tab_index,
                                        prev_tab: 'instance-copy-to-new-reference-tab', 
                                        next_tab: 'instance-edit-profile-tab' } %>
    <% end %>
  <% end %>

  <% if @tabs_to_offer.include?('tab_edit_profile') %>
    <% if Rails.configuration.try('profile_edit_aware') %>
      <% if can? 'classification', 'place' %>
        <%= render partial: 'instances/tabs/tab', locals: {first: false,
                                        last: true,
                                        this_tab: 'tab_edit_profile', 
                                        link_text: "Edit Profile".html_safe,
                                        link_id: 'instance-edit-profile-tab', 
                                        link_title: 'Edit Profile',
                                        tab_index: increment_tab_index,
                                        prev_tab: 'instance-profile-tab',
                                        next_tab: 'instance-batch-loader-tab' } %>
      <% end %>
    <% end %>
  <% end %>

  <% if @tabs_to_offer.include?('tab_batch_loader') %>
     <% if can?('loader/batches', 'process') %>
        <%= render partial: 'instances/tabs/tab', locals: {first: false,
                                        last: true,
                                        this_tab: 'tab_batch_loader', 
                                        link_text: "Loader 1".html_safe,
                                        link_id: 'instance-batch-loader-tab', 
                                        link_title: 'Batch Loader operations',
                                        tab_index: increment_tab_index,
                                        prev_tab: 'instance-edit-profile-tab',
                                        next_tab: 'instance-batch-loader-tab-2' } %>

        <%= render partial: 'instances/tabs/tab', locals: {first: false,
                                        last: true,
                                        this_tab: 'tab_batch_loader_2', 
                                        link_text: "Loader 2".html_safe,
                                        link_id: 'instance-batch-loader-tab-2', 
                                        link_title: 'More batch Loader operations',
                                        tab_index: increment_tab_index,
                                        prev_tab: 'instance-batch-tab-loader',
                                        next_tab: 'instance-show-tab' } %>
      <% end %>
  <% end %>

  

  <% if @tabs_to_offer.include?('tab_foa_profile') %>
    <% if can? :view, :foa_profile %>
      <% if Rails.configuration.try('foa_profile_aware') %>
        <%= render partial: 'instances/tabs/tab', locals: {first: false,
                                        last: true,
                                        this_tab: 'tab_foa_profile', 
                                        link_text: "foa profile".html_safe,
                                        link_id: 'instance-foa-profile-tab', 
                                        link_title: 'Foa',
                                        tab_index: increment_tab_index,
                                        prev_tab: 'instance-edit-profile-tab',
                                        next_tab: '.search-result.show-details' } %>
      <% end %>
    <% end %>
  <% end %>
</ul>
