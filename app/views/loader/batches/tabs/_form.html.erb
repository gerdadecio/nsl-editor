<%= form_with model: @loader_batch do |form| %>

  <input type="hidden" name="random_id" value="<%= params[:random_id] %>"/>
  <div class="form-group">
    <label for="name">Name<span class="red">*</span></label>
    <%= form.text_field :name, class: 'form-control', title: 'Edit the name of the batch', required: true %>
    <p class="help-block">
    Batch name must be unique and should be short &mdash; it will be listed in the search targets dropdown list &mdash;
    so best less than 15 characters.
    </p>
  </div>

  <div class="form-group">
    <label for="name">Description</label>
    <%= form.text_field :description, class: 'form-control', title: 'Edit the description of the batch' %>
    <p class="help-block">
    Use the description to supplement the name.
    </p>
   </div>

   <div class="typeahead-container">
      <section class='block width-100-percent'>
        <label for="loader-batch-default-reference-typeahead">Default Reference</label>
        <input id="loader-batch-default-reference-typeahead"
               name="loader_batch[default_reference_typeahead]" 
               class="typeahead form-control width-100-percent give-me-focus" 
               title="Enter the reference.  Typeahead for reference citation, allows unordered fragments."
               autofocus="true"
               tabindex="<%= increment_tab_index %>"
               type="text" 
               placeholder="Reference wildcarded search on citation"
               value="<%= @loader_batch.default_reference&.citation %>"/>
      </section>
    </div>

    <script> setUpLoaderBatchDefaultReferenceTypeahead(); </script>

    <%= form.hidden_field :default_reference_id %>


    <div class="form-group align-right">
   <% if @loader_batch.new_record? %>
     <%= link_to 'Cancel', '/cancel-new-form', id: 'loader-batch-cancel', class: "btn btn-primary cancel-new-record-link",
                  data: {element_id: "new-loader-batch-#{params[:random_id]}"}, 
                  title: "Cancel new loader_batch", tabindex: increment_tab_index  %>
   <% end %>
  <%= form.submit "Save", id: 'loader-batch-save', class: 'btn btn-primary width-5em', title: "Save changes", tabindex: increment_tab_index %>
    </div>

<% end %>

<div id="search-result-details-info-message-container" class="message-container"></div>
<div id="search-result-details-error-message-container" class="message-container"></div>
